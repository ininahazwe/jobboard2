{% extends 'base.html.twig' %}

{% block title %}Candidatures{% endblock %}

{% block body %}
<main id="main">
    <!-- ======= Breadcrumbs ======= -->
    <section id="breadcrumbs" class="breadcrumbs">
        <div class="container">
            <ol>
                <li><a href="{{ path('app_home') }}">Home</a></li>
                <li><a href="{{ path('app_profile') }}">Dashboard</a></li>
                <li><a href="{{ path('candidature_index') }}">Candidatures</a></li>
                <li>Candidatures</li>
            </ol>
            <h2>Gestion des candidatures</h2>
        </div>
    </section><!-- End Breadcrumbs -->
    <section class="inner-page">
        <div class="container">
            <div class="col-md-12">
                {% if app.user.isSuperAdmin() or app.user.isSuperRecruteur() or app.user.isRecruteur() %}
                    <table class="table table-striped table-bordered" id="datatable">
                        <thead>
                        <tr>
                            <th>Infos candidature</th>
                            <th>Infos offre</th>
                            <th>Statut</th>
                            <th>Suivi</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for candidature in candidatures %}
                            <tr>
                                <td>
                                    <b>Nom et prénom : </b>{{ candidature.candidat.fullname()|upper }}<br>
                                    <b>Date de candidature : </b>{{ candidature.createdAt ? candidature.createdAt|date('d-m-Y') : '' }}<br>
                                    {% if candidature.cv %}
                                        <a href=""><i class="fas fa-download"></i> Télécharger son cv</a>
                                    {% endif %}
                                </td>
                                <td>
                                    <b>Annonce : </b>{% for annonce in candidature.annonces %}
                                    <a href="{{ path('annonce_show_unit', {'id': annonce.id, 'slug': annonce.slug }) }}">{{ annonce.name }}</a>
                                    {% endfor %}<br>
                                    <b>Entreprise : </b><a href="{{ path('entreprise_show_unit', {'id': candidature.entreprise.id, 'slug': candidature.entreprise.slug }) }}">{{ candidature.entreprise }}</a> <br>
                                    <b>Recruteur : </b>{{ candidature.recruteur }}
                                </td>
                                <td></td>
                                <td>
                                    <div class="form-check form-switch">
                                        <button class="btn-sm btn-success">Accepter</button>
                                        <button class="btn-sm btn-danger">Refuser</button>
                                    </div>
                                </td>
                                <td>
                                    <a class="d-flex align-items-center" href="{{ path('candidature_show', {'id':candidature.id}) }}"><i class="fas fa-eye"></i></a>
                                </td>
                            </tr>
                        {% else %}
                            <tr>
                                <td colspan="6">no records found</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
                {% if app.user.isCandidat() %}
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Annonce</th>
                            <th>Entreprise</th>
                            <th>Date de candidature</th>
                            <th>Résumé</th>
                            <th>Suivi</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for candidature in candidatures %}
                            <tr>
                                <td>
                                    {% for annonce in candidature.annonces %}
                                        <a href="{{ path('annonce_show_unit', {'id': annonce.id, 'slug': annonce.slug }) }}">{{ annonce.name }}</a>
                                    {% endfor %}
                                </td>
                                <td><a href="{{ path('entreprise_show_unit', {'id': candidature.entreprise.id, 'slug': candidature.entreprise.slug }) }}">{{ candidature.entreprise }}</a></td>
                                <td>{{ candidature.createdAt ? candidature.createdAt|date('d-m-Y à H:i') : '' }}</td>
                                <td>
                                    <a href="{{ path('candidature_show', {'id': candidature.id}) }}"><i class="fas fa-eye"></i></a>
                                </td>
                                <td>

                                </td>
                            </tr>
                        {% else %}
                            <tr>
                                <td colspan="6">no records found</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div>
        </div>
    </section>
</main>
{% endblock %}
