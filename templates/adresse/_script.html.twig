<script>
    let collection, boutonAjout, span;
    window.onload = () => {
        collection = document.querySelector("#adresse");
        span = collection.querySelector("span");
        boutonAjout = document.createElement("button");
        boutonAjout.className = "btn app-btn-primary";
        boutonAjout.innerText = "Ajouter une adresse";
        let nouveauBouton = span.append(boutonAjout);
        collection.dataset.index = collection.querySelectorAll("input").length;
        boutonAjout.addEventListener("click", function () {
            addButton(collection, nouveauBouton);
            let indexAdresse = collection.dataset.index - 1
            completAdresse(indexAdresse);
        });
    }

    function addButton(collection, nouveauBouton) {
        let prototype = collection.dataset.prototype;
        let index = collection.dataset.index;
        prototype = prototype.replace(/__name__/g, index);
        let content = document.createElement("html");
        content.innerHTML = prototype;
        let newForm = content.querySelector("div");
        let boutonSuppr = document.createElement("button");
        boutonSuppr.type = "button";
        boutonSuppr.className = "btn-sm btn-danger mt-2";
        boutonSuppr.id = "delete-adresse-" + index;
        boutonSuppr.innerText = "Supprimer cette adresse";
        newForm.append(boutonSuppr);
        collection.dataset.index++;
        let boutonAjout = collection.querySelector(".ajout-adresse");
        span.insertBefore(newForm, boutonAjout);
        boutonSuppr.addEventListener("click", function () {

            this.previousElementSibling.parentElement.remove();
        })
        console.log(prototype);
    }

</script>
